import Plugin from '@ckeditor/ckeditor5-core/src/plugin';
import FileRepository from '@ckeditor/ckeditor5-upload/src/filerepository';
import UploadAdapter from './adapter';

export default class ImagesUpload extends Plugin {

    static get requires() {
        return [FileRepository];
    }

    static get pluginName() {
        return 'ImagesUpload';
    }

    init() {
        const url = this.editor.config.get('imagesUpload.uploadUrl');
        const headers = this.editor.config.get('imagesUpload.headers');

        if (!url) {
            console.warn('imagesUpload.uploadUrl is not configured')
            return;
        }

        this.editor.plugins.get('FileRepository').createUploadAdapter = loader => new UploadAdapter(loader, url, headers, this.editor.t);
    }
}
